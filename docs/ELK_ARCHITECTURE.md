# DeukNet ELK ë¡œê·¸ ìˆ˜ì§‘ ì•„í‚¤í…ì²˜

## ğŸ“Š ì „ì²´ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Kubernetes Cluster                           â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   myapp      â”‚  â”‚ log-generatorâ”‚  â”‚  Other Pods  â”‚              â”‚
â”‚  â”‚ (Spring Boot)â”‚  â”‚  (Test Pod)  â”‚  â”‚              â”‚              â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚              â”‚
â”‚  â”‚ Label:       â”‚  â”‚ Label:       â”‚  â”‚ No Label     â”‚              â”‚
â”‚  â”‚ collect-logs â”‚  â”‚ collect-logs â”‚  â”‚ (Excluded)   â”‚              â”‚
â”‚  â”‚   = true     â”‚  â”‚   = true     â”‚  â”‚              â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                 â”‚                                          â”‚
â”‚         â”‚ stdout/stderr   â”‚ stdout/stderr                           â”‚
â”‚         â–¼                 â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚        /var/log/containers/*.log (Node)              â”‚           â”‚
â”‚  â”‚        (Docker/containerd log files)                 â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                         â”‚                                            â”‚
â”‚                         â”‚ File Reading                               â”‚
â”‚                         â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚              Filebeat (DaemonSet)                        â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚        â”‚
â”‚  â”‚  â”‚ Autodiscovery:                                   â”‚    â”‚        â”‚
â”‚  â”‚  â”‚  - Kubernetes APIë¥¼ í†µí•œ Pod ëª¨ë‹ˆí„°ë§          â”‚    â”‚        â”‚
â”‚  â”‚  â”‚  - Label ê¸°ë°˜ í•„í„°ë§ (collect-logs: true)     â”‚    â”‚        â”‚
â”‚  â”‚  â”‚  - Kubernetes ë©”íƒ€ë°ì´í„° ì¶”ê°€                  â”‚    â”‚        â”‚
â”‚  â”‚  â”‚    * Namespace, Pod name, Container name       â”‚    â”‚        â”‚
â”‚  â”‚  â”‚    * Labels, Annotations                        â”‚    â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚        â”‚
â”‚  â”‚                                                           â”‚        â”‚
â”‚  â”‚  Processors:                                              â”‚        â”‚
â”‚  â”‚  - add_kubernetes_metadata                                â”‚        â”‚
â”‚  â”‚  - add_cloud_metadata                                     â”‚        â”‚
â”‚  â”‚  - drop_event (Job, kube-system ì œì™¸)                   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                             â”‚                                         â”‚
â”‚                             â”‚ Beats Protocol (Port 5044)              â”‚
â”‚                             â”‚ (êµ¬ì¡°í™”ëœ JSON ì´ë²¤íŠ¸ ì „ì†¡)            â”‚
â”‚                             â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚                Logstash (Deployment)                     â”‚         â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚         â”‚
â”‚  â”‚  â”‚ Input:                                           â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - beats { port => 5044 }                       â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - Filebeatë¡œë¶€í„° ì´ë²¤íŠ¸ ìˆ˜ì‹                   â”‚    â”‚         â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚         â”‚
â”‚  â”‚                                                           â”‚         â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚         â”‚
â”‚  â”‚  â”‚ Filter: (ì„ íƒì  - ì¶”ê°€ ê°€ëŠ¥)                   â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - grok: ë¡œê·¸ íŒŒì‹±                             â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - mutate: í•„ë“œ ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ                 â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - date: íƒ€ì„ìŠ¤íƒ¬í”„ íŒŒì‹±                       â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - drop: íŠ¹ì • ì´ë²¤íŠ¸ ì œì™¸                      â”‚    â”‚         â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚         â”‚
â”‚  â”‚                                                           â”‚         â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚         â”‚
â”‚  â”‚  â”‚ Output:                                          â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  elasticsearch {                                 â”‚    â”‚         â”‚
â”‚  â”‚  â”‚    hosts => ["http://elasticsearch:9200"]       â”‚    â”‚         â”‚
â”‚  â”‚  â”‚    user => "logstash_writer"                    â”‚    â”‚         â”‚
â”‚  â”‚  â”‚    password => "${ELASTICSEARCH_PASSWORD}"      â”‚    â”‚         â”‚
â”‚  â”‚  â”‚    index => "logs-%{+YYYY.MM.dd}"               â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  }                                               â”‚    â”‚         â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                             â”‚                                         â”‚
â”‚                             â”‚ HTTP REST API (Port 9200)               â”‚
â”‚                             â”‚ (Bulk APIë¡œ ë°°ì¹˜ ì¸ë±ì‹±)                â”‚
â”‚                             â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚            Elasticsearch (Deployment)                    â”‚         â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚         â”‚
â”‚  â”‚  â”‚ ì¸ë±ì‹±:                                          â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - ì¸ë±ìŠ¤: logs-YYYY.MM.dd                      â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - ìƒ¤ë“œ: 1 primary, 1 replica                  â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - ë§¤í•‘: ìë™ ìƒì„± (ECS í˜¸í™˜)                  â”‚    â”‚         â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚         â”‚
â”‚  â”‚                                                           â”‚         â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚         â”‚
â”‚  â”‚  â”‚ ì‚¬ìš©ì ê´€ë¦¬:                                     â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - elastic: ìŠˆí¼ê´€ë¦¬ì                          â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - kibana_system: Kibana ì „ìš©                  â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - logstash_writer: ë¡œê·¸ ì“°ê¸° + í…œí”Œë¦¿ ìƒì„±   â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - beats_system: Beats ëª¨ë‹ˆí„°ë§                â”‚    â”‚         â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚         â”‚
â”‚  â”‚                                                           â”‚         â”‚
â”‚  â”‚  ì €ì¥ëœ ë°ì´í„° êµ¬ì¡°:                                      â”‚         â”‚
â”‚  â”‚  {                                                        â”‚         â”‚
â”‚  â”‚    "@timestamp": "2025-10-15T00:00:00.000Z",            â”‚         â”‚
â”‚  â”‚    "message": "Application log message",                 â”‚         â”‚
â”‚  â”‚    "kubernetes": {                                       â”‚         â”‚
â”‚  â”‚      "namespace": "default",                             â”‚         â”‚
â”‚  â”‚      "pod": { "name": "myapp-xxx" },                    â”‚         â”‚
â”‚  â”‚      "container": { "name": "myapp" },                  â”‚         â”‚
â”‚  â”‚      "labels": { "app": "myapp" }                       â”‚         â”‚
â”‚  â”‚    }                                                      â”‚         â”‚
â”‚  â”‚  }                                                        â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                             â”‚                                         â”‚
â”‚                             â”‚ HTTP REST API (Port 9200)               â”‚
â”‚                             â”‚ (ê²€ìƒ‰, ì§‘ê³„ ì¿¼ë¦¬)                       â”‚
â”‚                             â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚                 Kibana (Deployment)                      â”‚         â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚         â”‚
â”‚  â”‚  â”‚ ê¸°ëŠ¥:                                            â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - Discover: ë¡œê·¸ ê²€ìƒ‰ ë° í•„í„°ë§               â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - Dashboard: ì‹œê°í™” ëŒ€ì‹œë³´ë“œ                  â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - Visualize: ì°¨íŠ¸/ê·¸ë˜í”„ ìƒì„±                 â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - Dev Tools: Elasticsearch ì¿¼ë¦¬              â”‚    â”‚         â”‚
â”‚  â”‚  â”‚  - Alerting: ì•ŒëŒ ê·œì¹™ ì„¤ì •                   â”‚    â”‚         â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚         â”‚
â”‚  â”‚                                                           â”‚         â”‚
â”‚  â”‚  User: elastic / kibana_system                            â”‚         â”‚
â”‚  â”‚  Password: deuknet2024                                    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

             â–²
             â”‚
             â”‚ Port-Forward / NodePort / LoadBalancer
             â”‚ (http://localhost:5601)
             â”‚
        â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
        â”‚  User   â”‚
        â”‚ Browser â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ ë°ì´í„° íë¦„ ìƒì„¸ ì„¤ëª…

### 1ï¸âƒ£ **ë¡œê·¸ ìƒì„± ë‹¨ê³„**
```
Application â†’ stdout/stderr
```
- Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë¡œê·¸ ì¶œë ¥
- System.out.println(), logger.info() ë“±
- Kubernetesê°€ ìë™ìœ¼ë¡œ íŒŒì¼ë¡œ ì €ì¥
  * ìœ„ì¹˜: `/var/log/containers/<pod>_<namespace>_<container>-<id>.log`
  * í¬ë§·: JSON Lines (ê° ì¤„ì´ JSON ê°ì²´)

**íŒŒì¼ ì˜ˆì‹œ:**
```json
{"log":"2025-10-15 00:00:00 INFO  Application started\n","stream":"stdout","time":"2025-10-15T00:00:00.123456789Z"}
```

### 2ï¸âƒ£ **ë¡œê·¸ ìˆ˜ì§‘ ë‹¨ê³„ (Filebeat)**
```
Log Files â†’ Filebeat â†’ Structured Events
```

**Filebeatì˜ ì—­í• :**
- **Autodiscovery**: Kubernetes APIë¥¼ ëª¨ë‹ˆí„°ë§í•˜ì—¬ ìƒˆë¡œìš´ Pod ê°ì§€
- **í•„í„°ë§**: `collect-logs: true` ë¼ë²¨ì´ ìˆëŠ” Podë§Œ ì„ íƒ
- **ë©”íƒ€ë°ì´í„° ì¶”ê°€**: 
  ```json
  {
    "kubernetes": {
      "namespace": "default",
      "pod": {"name": "myapp-xxx", "uid": "..."},
      "container": {"name": "myapp"},
      "labels": {"app": "myapp", "collect-logs": "true"},
      "node": {"name": "minikube"}
    }
  }
  ```
- **ì´ë²¤íŠ¸ ì „ì†¡**: Beats Protocolë¡œ Logstashì— ì „ì†¡

**Filebeatê°€ ë³´ë‚´ëŠ” ì´ë²¤íŠ¸ êµ¬ì¡°:**
```json
{
  "@timestamp": "2025-10-15T00:00:00.000Z",
  "message": "Application started",
  "log": {"file": {"path": "/var/log/containers/..."}},
  "kubernetes": {...},
  "host": {"name": "minikube"},
  "agent": {"type": "filebeat", "version": "8.11.0"}
}
```

### 3ï¸âƒ£ **ë¡œê·¸ ì²˜ë¦¬ ë‹¨ê³„ (Logstash)**
```
Filebeat Events â†’ Logstash Pipeline â†’ Elasticsearch
```

**Logstash Pipeline êµ¬ì¡°:**
```ruby
input {
  # Filebeatë¡œë¶€í„° ì´ë²¤íŠ¸ ìˆ˜ì‹ 
  beats {
    port => 5044
    # Beats Protocol (ì••ì¶•, ì•”í˜¸í™” ì§€ì›)
  }
}

filter {
  # í˜„ì¬ëŠ” ë¹„ì–´ìˆìŒ (ì¶”ê°€ ê°€ëŠ¥)
  # ì˜ˆ: grokìœ¼ë¡œ ë¡œê·¸ íŒŒì‹±
  # ì˜ˆ: mutateë¡œ í•„ë“œ ë³€í™˜
  # ì˜ˆ: dateë¡œ íƒ€ì„ìŠ¤íƒ¬í”„ íŒŒì‹±
}

output {
  # Elasticsearchì— ë²Œí¬ë¡œ ì „ì†¡
  elasticsearch {
    hosts => ["http://elasticsearch:9200"]
    user => "logstash_writer"
    password => "${ELASTICSEARCH_PASSWORD}"
    index => "logs-%{+YYYY.MM.dd}"  # ë‚ ì§œë³„ ì¸ë±ìŠ¤
    # ì˜ˆ: logs-2025.10.15
  }
}
```

**Logstashì˜ ì£¼ìš” ê¸°ëŠ¥:**
- **ë²„í¼ë§**: ì¼ì‹œì ì¸ Elasticsearch ì¥ì•  ëŒ€ì‘
- **ë°°ì¹˜ ì²˜ë¦¬**: ì—¬ëŸ¬ ì´ë²¤íŠ¸ë¥¼ ëª¨ì•„ì„œ í•œ ë²ˆì— ì „ì†¡ (ì„±ëŠ¥ ìµœì í™”)
- **ë³€í™˜**: í•„ìš”ì‹œ ë¡œê·¸ í˜•ì‹ ë³€í™˜
- **ë¼ìš°íŒ…**: ì¡°ê±´ì— ë”°ë¼ ë‹¤ë¥¸ ì¸ë±ìŠ¤ë¡œ ì „ì†¡ ê°€ëŠ¥

### 4ï¸âƒ£ **ë¡œê·¸ ì €ì¥ ë‹¨ê³„ (Elasticsearch)**
```
Logstash â†’ Elasticsearch REST API â†’ Index â†’ Shard
```

**ì¸ë±ì‹± í”„ë¡œì„¸ìŠ¤:**
1. **ì¸ë±ìŠ¤ ìƒì„±**: `logs-2025.10.15` (ë‚ ì§œë³„ ìë™ ìƒì„±)
2. **ë§¤í•‘ ìƒì„±**: í•„ë“œ íƒ€ì… ìë™ ì¶”ë¡ 
   ```json
   {
     "mappings": {
       "properties": {
         "@timestamp": {"type": "date"},
         "message": {"type": "text"},
         "kubernetes.pod.name": {"type": "keyword"}
       }
     }
   }
   ```
3. **ë¬¸ì„œ ì €ì¥**: JSON ë¬¸ì„œë¥¼ ì¸ë±ìŠ¤ì— ì €ì¥
4. **ì—­ìƒ‰ì¸ ìƒì„±**: ë¹ ë¥¸ ê²€ìƒ‰ì„ ìœ„í•œ ìƒ‰ì¸ êµ¬ì¡°

**ì¸ë±ìŠ¤ êµ¬ì¡°:**
```
logs-2025.10.15
â”œâ”€â”€ Primary Shard 0
â”‚   â”œâ”€â”€ Document 1 (myapp log)
â”‚   â”œâ”€â”€ Document 2 (log-generator log)
â”‚   â””â”€â”€ Document 3 (myapp log)
â””â”€â”€ Replica Shard 0 (ë°±ì—…)
```

**Elasticsearchì˜ ì—­í• :**
- **ì¸ë±ì‹±**: ë¡œê·¸ë¥¼ ê²€ìƒ‰ ê°€ëŠ¥í•œ í˜•íƒœë¡œ ì €ì¥
- **ê²€ìƒ‰**: ì „ë¬¸ ê²€ìƒ‰ (Full-text search)
- **ì§‘ê³„**: í†µê³„, ê·¸ë£¹í™”, í‰ê·  ë“± ê³„ì‚°
- **ë¶„ì„**: í…ìŠ¤íŠ¸ ë¶„ì„, í† í°í™”

### 5ï¸âƒ£ **ë¡œê·¸ ì‹œê°í™” ë‹¨ê³„ (Kibana)**
```
User â†’ Kibana â†’ Elasticsearch Query â†’ Results
```

**Kibanaì˜ ì£¼ìš” ê¸°ëŠ¥:**

1. **Discover (ê²€ìƒ‰)**
   - ì‹¤ì‹œê°„ ë¡œê·¸ ê²€ìƒ‰
   - KQL (Kibana Query Language) ì‚¬ìš©
   - ì˜ˆ: `kubernetes.pod.name: "myapp-*" AND message: "error"`

2. **Visualize (ì‹œê°í™”)**
   - Line Chart: ì‹œê°„ëŒ€ë³„ ë¡œê·¸ ê°œìˆ˜
   - Pie Chart: ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ ë¡œê·¸ ë¹„ìœ¨
   - Table: ì—ëŸ¬ ë¡œê·¸ ëª©ë¡

3. **Dashboard (ëŒ€ì‹œë³´ë“œ)**
   - ì—¬ëŸ¬ ì‹œê°í™”ë¥¼ í•œ í™”ë©´ì— ë°°ì¹˜
   - ì‹¤ì‹œê°„ ìë™ ê°±ì‹ 

4. **Dev Tools (ê°œë°œ ë„êµ¬)**
   - Elasticsearchì— ì§ì ‘ ì¿¼ë¦¬
   ```json
   GET logs-*/_search
   {
     "query": {
       "match": {"message": "error"}
     }
   }
   ```

5. **Alerting (ì•ŒëŒ)**
   - íŠ¹ì • ì¡°ê±´ ë§Œì¡± ì‹œ ì•Œë¦¼
   - ì˜ˆ: ì—ëŸ¬ ë¡œê·¸ê°€ ë¶„ë‹¹ 10ê°œ ì´ˆê³¼ ì‹œ

## ğŸ” ë³´ì•ˆ ë° ì¸ì¦

### ì‚¬ìš©ìë³„ ê¶Œí•œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì‚¬ìš©ì          â”‚ ì—­í•              â”‚ ê¶Œí•œ                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ elastic         â”‚ ìŠˆí¼ê´€ë¦¬ì       â”‚ ëª¨ë“  ê¶Œí•œ               â”‚
â”‚ kibana_system   â”‚ Kibana ì „ìš©      â”‚ Kibana ë‚´ë¶€ í†µì‹         â”‚
â”‚ logstash_writer â”‚ ë¡œê·¸ ì“°ê¸°        â”‚ ì¸ë±ìŠ¤ ìƒì„±/ì“°ê¸°        â”‚
â”‚                 â”‚                  â”‚ í…œí”Œë¦¿ ê´€ë¦¬             â”‚
â”‚ beats_system    â”‚ Beats ëª¨ë‹ˆí„°ë§   â”‚ Beats ìƒíƒœ ì „ì†¡         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì¸ì¦ íë¦„

```
Logstash â†’ Elasticsearch
  â”œâ”€ User: logstash_writer
  â”œâ”€ Password: deuknet2024 (Secret)
  â””â”€ Action: POST /logs-2025.10.15/_bulk
      â””â”€ ê¶Œí•œ í™•ì¸: logstash_writer role
          â””â”€ indices:write on logs-*  âœ… Allowed

Kibana â†’ Elasticsearch  
  â”œâ”€ User: kibana_system
  â”œâ”€ Password: deuknet2024 (Secret)
  â””â”€ Action: GET /.kibana/*
      â””â”€ ê¶Œí•œ í™•ì¸: kibana_system role  âœ… Allowed

User â†’ Kibana
  â”œâ”€ User: elastic
  â”œâ”€ Password: deuknet2024
  â””â”€ Session: Cookie-based authentication
```

## ğŸ“Š ë°ì´í„° ë¼ì´í”„ì‚¬ì´í´

```
Day 1: logs-2025.10.15
  â”œâ”€ ìƒì„±: ì²« ë¡œê·¸ ë„ì°© ì‹œ ìë™ ìƒì„±
  â”œâ”€ ì“°ê¸°: í•˜ë£¨ ì¢…ì¼ ë¡œê·¸ ìˆ˜ì§‘
  â””â”€ í¬ê¸°: ~100MB - 10GB (ë¡œê·¸ëŸ‰ì— ë”°ë¼)

Day 2: logs-2025.10.16
  â”œâ”€ ìƒì„±: ìƒˆë¡œìš´ ì¸ë±ìŠ¤ ìë™ ìƒì„±
  â”œâ”€ ì´ì „ ì¸ë±ìŠ¤: ì½ê¸° ì „ìš©ìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥
  â””â”€ ê²€ìƒ‰: logs-* íŒ¨í„´ìœ¼ë¡œ ëª¨ë“  ì¸ë±ìŠ¤ ê²€ìƒ‰

Day 30: logs-2025.09.15
  â”œâ”€ ì˜¤ë˜ëœ ì¸ë±ìŠ¤ ì‚­ì œ (ì„ íƒì‚¬í•­)
  â””â”€ Index Lifecycle Management (ILM) ì‚¬ìš© ê°€ëŠ¥
```

## ğŸš€ ì„±ëŠ¥ ìµœì í™”

### 1. **Filebeat ë ˆë²¨**
- Label ê¸°ë°˜ í•„í„°ë§ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ë¡œê·¸ ì œì™¸
- Multiline ì„¤ì •ìœ¼ë¡œ ìŠ¤íƒíŠ¸ë ˆì´ìŠ¤ ê·¸ë£¹í™”
- ë²„í¼ë§ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨ì„± í–¥ìƒ

### 2. **Logstash ë ˆë²¨**
- Pipeline ì›Œì»¤ ìˆ˜ ì¡°ì • (`pipeline.workers`)
- ë°°ì¹˜ í¬ê¸° ìµœì í™” (`batch.size`, `batch.delay`)
- í•„í„° ìµœì†Œí™” (ë¬´ê±°ìš´ grok íŒ¨í„´ íšŒí”¼)

### 3. **Elasticsearch ë ˆë²¨**
- ìƒ¤ë“œ ê°œìˆ˜ ìµœì í™” (ì¼ì¼ ë¡œê·¸ëŸ‰ì— ë”°ë¼)
- ë¦¬í”Œë¦¬ì¹´ ì„¤ì • (ê³ ê°€ìš©ì„± vs ë””ìŠ¤í¬ ê³µê°„)
- ì¸ë±ìŠ¤ í…œí”Œë¦¿ìœ¼ë¡œ ë§¤í•‘ ìµœì í™”

### 4. **Kibana ë ˆë²¨**
- ì‹œê°„ ë²”ìœ„ ì œí•œ (ìµœê·¼ 15ë¶„, 1ì‹œê°„ ë“±)
- í•„ë“œ í•„í„°ë§ (í•„ìš”í•œ í•„ë“œë§Œ í‘œì‹œ)
- ëŒ€ì‹œë³´ë“œ ìºì‹±

## ğŸ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë¡œê·¸ê°€ Kibanaì— ì•ˆ ë³´ì¼ ë•Œ:

```
1. Filebeat í™•ì¸
   kubectl logs -f daemonset/filebeat
   â†’ "Events sent" ë©”ì‹œì§€ í™•ì¸
   â†’ Label í•„í„°ë§ í™•ì¸ (collect-logs: true)

2. Logstash í™•ì¸
   kubectl logs -f deployment/logstash
   â†’ "Connection from" ë©”ì‹œì§€ í™•ì¸
   â†’ Elasticsearch ì—°ê²° í™•ì¸

3. Elasticsearch í™•ì¸
   kubectl exec deployment/elasticsearch -- \
     curl -u elastic:deuknet2024 \
     http://localhost:9200/_cat/indices/logs-*?v
   â†’ ì¸ë±ìŠ¤ ìƒì„± í™•ì¸
   â†’ ë¬¸ì„œ ê°œìˆ˜ í™•ì¸

4. Kibana í™•ì¸
   â†’ Data View ìƒì„± í™•ì¸ (logs-*)
   â†’ ì‹œê°„ ë²”ìœ„ í™•ì¸ (Last 15 minutes)
   â†’ í•„í„° í™•ì¸
```

## ğŸ“ˆ ëª¨ë‹ˆí„°ë§ ì§€í‘œ

en/beats/filebeat/
- Logstash íŒŒì´í”„ë¼ì¸: https://www.elastic.co/guide/en/logstash/
- Kibana ê°€ì´ë“œ: https://www.elastic.co/guide/en/kibana/

## ğŸ’¡ ì‹¤ì „ í™œìš© ì˜ˆì‹œ

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì—ëŸ¬ ë¡œê·¸ ì¶”ì 

```
ë¬¸ì œ: í”„ë¡œë•ì…˜ì—ì„œ ê°„í—ì ìœ¼ë¡œ NullPointerException ë°œìƒ

1. Kibana Discoverì—ì„œ ê²€ìƒ‰:
   kubernetes.pod.name: "myapp-*" AND message: "NullPointerException"

2. ì‹œê°„ëŒ€ ë¶„ì„:
   - Line Chartë¡œ ì—ëŸ¬ ë°œìƒ íŒ¨í„´ í™•ì¸
   - íŠ¹ì • ì‹œê°„ëŒ€ì— ì§‘ì¤‘ë˜ëŠ”ì§€ í™•ì¸

3. ì»¨í…ìŠ¤íŠ¸ í™•ì¸:
   - í•´ë‹¹ ë¡œê·¸ì˜ ì „í›„ ë¡œê·¸ í™•ì¸
   - Request IDë¡œ ì „ì²´ íŠ¸ëœì­ì…˜ ì¶”ì 

4. ê·¼ë³¸ ì›ì¸ ë¶„ì„:
   - ì–´ë–¤ API í˜¸ì¶œì—ì„œ ë°œìƒí–ˆëŠ”ì§€
   - ì–´ë–¤ ì‚¬ìš©ì/ìš”ì²­ì—ì„œ ë°œìƒí–ˆëŠ”ì§€
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

```
ëª©í‘œ: API ì‘ë‹µ ì‹œê°„ ëª¨ë‹ˆí„°ë§

1. êµ¬ì¡°í™”ëœ ë¡œê¹…:
   logger.info("API call completed",
     kv("endpoint", "/api/users"),
     kv("method", "GET"),
     kv("duration_ms", 234),
     kv("status", 200)
   );

2. Logstash í•„í„°ë¡œ ìˆ«ì ë³€í™˜:
   mutate {
     convert => { "duration_ms" => "integer" }
   }

3. Kibana Visualize:
   - Metric: Average of duration_ms
   - Line Chart: duration_ms over time
   - Heatmap: endpointë³„ ì‘ë‹µ ì‹œê°„

4. ì•ŒëŒ ì„¤ì •:
   - duration_ms > 1000msì¼ ë•Œ ì•Œë¦¼
   - Slackìœ¼ë¡œ ì¦‰ì‹œ í†µë³´
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ì‚¬ìš©ì í–‰ë™ ë¶„ì„

```
ëª©í‘œ: ì‚¬ìš©ì ë¡œê·¸ì¸ íŒ¨í„´ ë¶„ì„

1. ë¡œê·¸ ìˆ˜ì§‘:
   logger.info("User login",
     kv("userId", userId),
     kv("loginTime", timestamp),
     kv("ipAddress", ip)
   );

2. Kibana ë¶„ì„:
   - Pie Chart: ì‹œê°„ëŒ€ë³„ ë¡œê·¸ì¸ ë¶„í¬
   - Data Table: ê°€ì¥ í™œë™ì ì¸ ì‚¬ìš©ì Top 10
   - Geo Map: ì§€ì—­ë³„ ë¡œê·¸ì¸ (IP ê¸°ë°˜)

3. ì´ìƒ íƒì§€:
   - ë™ì¼ userIdë¡œ ì§§ì€ ì‹œê°„ ë‚´ ì—¬ëŸ¬ IPì—ì„œ ë¡œê·¸ì¸
   - ë¹„ì •ìƒì ì¸ ì‹œê°„ëŒ€ ë¡œê·¸ì¸ (ìƒˆë²½ 2-4ì‹œ)
```

### ì‹œë‚˜ë¦¬ì˜¤ 4: ë””ë²„ê¹… ì„¸ì…˜

```
ë¬¸ì œ: íŠ¹ì • ê¸°ëŠ¥ì´ ê°„í—ì ìœ¼ë¡œ ì‹¤íŒ¨

1. ì„ì‹œë¡œ DEBUG ë ˆë²¨ í™œì„±í™”:
   kubectl set env deployment/myapp LOGGING_LEVEL_ROOT=DEBUG

2. ìƒì„¸ ë¡œê·¸ ìˆ˜ì§‘:
   - ë©”ì†Œë“œ ì§„ì…/ì¢…ë£Œ ë¡œê·¸
   - ë³€ìˆ˜ ê°’ ë¡œê·¸
   - ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ë¡œê·¸

3. Kibanaì—ì„œ ë¶„ì„:
   - Request IDë¡œ ì „ì²´ í”Œë¡œìš° ì¶”ì 
   - ê° ë‹¨ê³„ë³„ ì†Œìš” ì‹œê°„ í™•ì¸
   - ì‹¤íŒ¨ ì§€ì  íŠ¹ì •

4. ë¬¸ì œ í•´ê²° í›„ ë¡œê·¸ ë ˆë²¨ ë³µêµ¬:
   kubectl set env deployment/myapp LOGGING_LEVEL_ROOT=INFO
```

## ğŸ¨ Kibana ëŒ€ì‹œë³´ë“œ ì˜ˆì‹œ

### ëŒ€ì‹œë³´ë“œ 1: ì• í”Œë¦¬ì¼€ì´ì…˜ ê±´ê°• ìƒíƒœ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Application Health Dashboard                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  [Total Logs: 125,234]  [Errors: 45]  [Warnings: 289]  â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Log Volume (Last 24h)                   â”‚          â”‚
â”‚  â”‚  [Line Chart showing log count over time]â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Error Rate         â”‚  â”‚  Top Errors         â”‚      â”‚
â”‚  â”‚  [Gauge: 0.036%]    â”‚  â”‚  1. NPE: 12 times  â”‚      â”‚
â”‚  â”‚                     â”‚  â”‚  2. SQL: 8 times   â”‚      â”‚
â”‚  â”‚                     â”‚  â”‚  3. IO: 6 times    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Logs by Pod                              â”‚          â”‚
â”‚  â”‚  [Pie Chart: myapp-xxx 60%, myapp-yyy 40%]â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ëŒ€ì‹œë³´ë“œ 2: ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Performance Monitoring                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  [Avg Response Time: 145ms]  [P95: 340ms]  [P99: 890ms]â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Response Time Trend                      â”‚          â”‚
â”‚  â”‚  [Area Chart showing response time]       â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Slowest Endpoints                        â”‚          â”‚
â”‚  â”‚  /api/reports: 2.3s                      â”‚          â”‚
â”‚  â”‚  /api/analytics: 1.8s                    â”‚          â”‚
â”‚  â”‚  /api/export: 1.2s                       â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Request Volume Heatmap                   â”‚          â”‚
â”‚  â”‚  [Heatmap by hour and endpoint]           â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ê³ ê¸‰ Logstash í•„í„° ì˜ˆì‹œ

### Java ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ íŒŒì‹±

```ruby
filter {
  # Multiline: ìŠ¤íƒíŠ¸ë ˆì´ìŠ¤ í•©ì¹˜ê¸°
  if [kubernetes][container][name] == "myapp" {
    
    # JSON ë¡œê·¸ íŒŒì‹±
    if [message] =~ /^{.*}$/ {
      json {
        source => "message"
        target => "app"
      }
    }
    
    # ì¼ë°˜ í…ìŠ¤íŠ¸ ë¡œê·¸ íŒŒì‹±
    else {
      grok {
        match => {
          "message" => "%{TIMESTAMP_ISO8601:timestamp} %{LOGLEVEL:log_level} \[%{DATA:thread}\] %{JAVACLASS:logger} : %{GREEDYDATA:log_message}"
        }
      }
      
      # íƒ€ì„ìŠ¤íƒ¬í”„ íŒŒì‹±
      date {
        match => ["timestamp", "ISO8601"]
        target => "@timestamp"
      }
    }
    
    # ì—ëŸ¬ ë ˆë²¨ì— ë”°ë¼ í•„ë“œ ì¶”ê°€
    if [log_level] == "ERROR" {
      mutate {
        add_field => { "severity" => "high" }
        add_tag => ["error"]
      }
    }
    
    # ë¯¼ê°í•œ ì •ë³´ ë§ˆìŠ¤í‚¹
    mutate {
      gsub => [
        "message", "password=[^&\s]+", "password=***",
        "message", "token=[^&\s]+", "token=***"
      ]
    }
    
    # Request ID ì¶”ì¶œ
    if [message] =~ /request_id=/ {
      grok {
        match => { "message" => "request_id=%{UUID:request_id}" }
      }
    }
    
    # ë¶ˆí•„ìš”í•œ í•„ë“œ ì œê±°
    mutate {
      remove_field => ["agent", "ecs", "input"]
    }
  }
}
```

### ì¡°ê±´ë¶€ ë¼ìš°íŒ…

```ruby
output {
  # ì—ëŸ¬ ë¡œê·¸ëŠ” ë³„ë„ ì¸ë±ìŠ¤ë¡œ
  if "error" in [tags] {
    elasticsearch {
      hosts => ["${ELASTICSEARCH_HOSTS}"]
      user => "${ELASTICSEARCH_USERNAME}"
      password => "${ELASTICSEARCH_PASSWORD}"
      index => "errors-%{+YYYY.MM.dd}"
    }
  }
  
  # ì¼ë°˜ ë¡œê·¸
  else {
    elasticsearch {
      hosts => ["${ELASTICSEARCH_HOSTS}"]
      user => "${ELASTICSEARCH_USERNAME}"
      password => "${ELASTICSEARCH_PASSWORD}"
      index => "logs-%{+YYYY.MM.dd}"
    }
  }
  
  # ê°œë°œ í™˜ê²½ì—ì„œëŠ” stdout ì¶œë ¥
  if [kubernetes][namespace] == "dev" {
    stdout {
      codec => rubydebug
    }
  }
}
```

## ğŸ“Š ì¸ë±ìŠ¤ í…œí”Œë¦¿ ìµœì í™”

### ì»¤ìŠ¤í…€ ì¸ë±ìŠ¤ í…œí”Œë¦¿

```json
PUT _index_template/logs-template
{
  "index_patterns": ["logs-*"],
  "template": {
    "settings": {
      "number_of_shards": 1,
      "number_of_replicas": 1,
      "index.lifecycle.name": "logs-policy",
      "index.lifecycle.rollover_alias": "logs"
    },
    "mappings": {
      "properties": {
        "@timestamp": {
          "type": "date"
        },
        "message": {
          "type": "text",
          "fields": {
            "keyword": {
              "type": "keyword",
              "ignore_above": 256
            }
          }
        },
        "log_level": {
          "type": "keyword"
        },
        "duration_ms": {
          "type": "long"
        },
        "kubernetes": {
          "properties": {
            "pod": {
              "properties": {
                "name": {"type": "keyword"}
              }
            },
            "namespace": {"type": "keyword"},
            "container": {
              "properties": {
                "name": {"type": "keyword"}
              }
            }
          }
        }
      }
    }
  }
}
```

### Index Lifecycle Management (ILM)

```json
PUT _ilm/policy/logs-policy
{
  "policy": {
    "phases": {
      "hot": {
        "min_age": "0ms",
        "actions": {
          "rollover": {
            "max_size": "50GB",
            "max_age": "1d"
          },
          "set_priority": {
            "priority": 100
          }
        }
      },
      "warm": {
        "min_age": "7d",
        "actions": {
          "readonly": {},
          "forcemerge": {
            "max_num_segments": 1
          },
          "set_priority": {
            "priority": 50
          }
        }
      },
      "cold": {
        "min_age": "30d",
        "actions": {
          "set_priority": {
            "priority": 0
          }
        }
      },
      "delete": {
        "min_age": "90d",
        "actions": {
          "delete": {}
        }
      }
    }
  }
}
```

## ğŸ¯ ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì¼ì¼ ì ê²€ í•­ëª©

```
â–¡ Elasticsearch í´ëŸ¬ìŠ¤í„° ìƒíƒœ (Green)
  kubectl exec deployment/elasticsearch -- \
    curl -u elastic:deuknet2024 http://localhost:9200/_cluster/health

â–¡ ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ (<80%)
  kubectl exec deployment/elasticsearch -- \
    df -h

â–¡ ì¸ë±ìŠ¤ í¬ê¸° í™•ì¸
  kubectl exec deployment/elasticsearch -- \
    curl -u elastic:deuknet2024 \
    'http://localhost:9200/_cat/indices/logs-*?v&h=index,store.size&s=index:desc'

â–¡ Filebeat ì •ìƒ ì‘ë™
  kubectl get pods -l app=filebeat

â–¡ Logstash ì²˜ë¦¬ëŸ‰ í™•ì¸
  kubectl logs deployment/logstash | grep "events"

â–¡ ì—ëŸ¬ ë¡œê·¸ ê²€í†  (Kibana)
  - ìƒˆë¡œìš´ ì—ëŸ¬ íŒ¨í„´ í™•ì¸
  - ì—ëŸ¬ ì¦ê°€ ì¶”ì„¸ í™•ì¸
```

### ì£¼ê°„ ì ê²€ í•­ëª©

```
â–¡ ì¸ë±ìŠ¤ ì •ë¦¬
  - 90ì¼ ì´ìƒ ëœ ì¸ë±ìŠ¤ ì‚­ì œ
  - ILM ì •ì±… ì‹¤í–‰ ìƒíƒœ í™•ì¸

â–¡ ì„±ëŠ¥ ë¦¬ë·°
  - í‰ê·  ì‘ë‹µ ì‹œê°„ ì¶”ì´
  - ëŠë¦° ì¿¼ë¦¬ ë¶„ì„
  - ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ë¥  ê²€í† 

â–¡ ë³´ì•ˆ ì ê²€
  - ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í•„ìš”ì„± ê²€í† 
  - ì ‘ê·¼ ë¡œê·¸ ê²€í† 
  - ë¹„ì •ìƒ ë¡œê·¸ì¸ ì‹œë„ í™•ì¸

â–¡ ë°±ì—… í™•ì¸
  - ìŠ¤ëƒ…ìƒ· ìƒì„± ìƒíƒœ
  - ë³µêµ¬ í…ŒìŠ¤íŠ¸
```

## ğŸš¨ ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: Elasticsearch ë””ìŠ¤í¬ í’€

```bash
# ì¦ìƒ
cluster.routing.allocation.disk.threshold_exceeded

# í•´ê²°
1. ì˜¤ë˜ëœ ì¸ë±ìŠ¤ ì‚­ì œ
   kubectl exec deployment/elasticsearch -- \
     curl -X DELETE -u elastic:deuknet2024 \
     'http://localhost:9200/logs-2025.01.*'

2. ë””ìŠ¤í¬ ì„ê³„ê°’ ì„ì‹œ ì¡°ì •
   PUT _cluster/settings
   {
     "transient": {
       "cluster.routing.allocation.disk.watermark.low": "95%",
       "cluster.routing.allocation.disk.watermark.high": "97%"
     }
   }

3. ë³¼ë¥¨ í™•ì¥ (ì˜êµ¬ í•´ê²°)
```

### ë¬¸ì œ 2: Logstash ë©”ëª¨ë¦¬ ë¶€ì¡±

```bash
# ì¦ìƒ
OutOfMemoryError in Logstash logs

# í•´ê²°
1. JVM í™ í¬ê¸° ì¡°ì •
   env:
   - name: LS_JAVA_OPTS
     value: "-Xms1g -Xmx1g"

2. ë¦¬ì†ŒìŠ¤ ì œí•œ ì¦ê°€
   resources:
     limits:
       memory: "2Gi"

3. Pipeline ì›Œì»¤ ìˆ˜ ê°ì†Œ
   pipeline.workers: 2
```

### ë¬¸ì œ 3: Filebeat ë¡œê·¸ ìœ ì‹¤

```bash
# ì¦ìƒ
ë¡œê·¸ê°€ ê°„í—ì ìœ¼ë¡œ ëˆ„ë½ë¨

# í•´ê²°
1. Filebeat registry í™•ì¸
   kubectl exec daemonset/filebeat -- \
     cat /usr/share/filebeat/data/registry/filebeat/log.json

2. ë°±í”„ë ˆì…” í™•ì¸
   kubectl logs daemonset/filebeat | grep "publish"

3. Logstash í í¬ê¸° ì¦ê°€
   queue.type: persisted
   queue.max_bytes: 1gb
```

### ë¬¸ì œ 4: Kibana ëŠë¦° ì‘ë‹µ

```bash
# í•´ê²°
1. ì‹œê°„ ë²”ìœ„ ì œí•œ
   - Last 15 minutes ëŒ€ì‹  Last 1 hour

2. í•„ë“œ ìˆ˜ ì œí•œ
   - í•„ìš”í•œ í•„ë“œë§Œ ì„ íƒ í‘œì‹œ

3. Kibana ìºì‹œ í´ë¦¬ì–´
   kubectl delete pod -l app=kibana

4. ì¸ë±ìŠ¤ íŒ¨í„´ ìµœì í™”
   - logs-* ëŒ€ì‹  logs-2025.10.* ì‚¬ìš©
```

## ğŸ“š ì¶”ê°€ í•™ìŠµ ìë£Œ

### ELK ìŠ¤íƒ ì‹¬í™”

1. **Elasticsearch Deep Dive**
   - ìƒ¤ë“œì™€ ë¦¬í”Œë¦¬ì¹´ ì „ëµ
   - ê²€ìƒ‰ ìµœì í™”
   - ì§‘ê³„ ì¿¼ë¦¬ ê³ ê¸‰ ê¸°ë²•

2. **Logstash Patterns**
   - Grok íŒ¨í„´ ì‘ì„±ë²•
   - ì»¤ìŠ¤í…€ í”ŒëŸ¬ê·¸ì¸ ê°œë°œ
   - ì„±ëŠ¥ íŠœë‹

3. **Kibana Advanced**
   - Canvasë¡œ í”„ë ˆì  í…Œì´ì…˜
   - Machine Learning ì´ìƒ íƒì§€
   - ì•ŒëŒ ë° ì•Œë¦¼ ì„¤ì •

4. **Beats ìƒíƒœê³„**
   - Metricbeat: ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­
   - Packetbeat: ë„¤íŠ¸ì›Œí¬ íŒ¨í‚·
   - Heartbeat: ì—…íƒ€ì„ ëª¨ë‹ˆí„°ë§

### Kubernetes + ELK

1. **ìš´ì˜ ìë™í™”**
   - Helm Chartë¡œ ë°°í¬
   - Operator íŒ¨í„´
   - GitOps with ArgoCD

2. **ê³ ê°€ìš©ì„± êµ¬ì„±**
   - Multi-node Elasticsearch
   - StatefulSet vs Deployment
   - PersistentVolume ì „ëµ

3. **ë³´ì•ˆ ê°•í™”**
   - TLS/SSL ì„¤ì •
   - RBAC ì„¸ë°€í™”
   - NetworkPolicy ì ìš©
   - Secrets ê´€ë¦¬ (Vault ì—°ë™)

## ğŸ“ ë§ˆë¬´ë¦¬

ì´ ë¬¸ì„œì—ì„œ ë‹¤ë£¬ ë‚´ìš©:

âœ… ELK ìŠ¤íƒì˜ ì „ì²´ ì•„í‚¤í…ì²˜
âœ… ê° ì»´í¬ë„ŒíŠ¸ì˜ ì—­í• ê³¼ ë™ì‘ ì›ë¦¬
âœ… ë°ì´í„° íë¦„ê³¼ ì²˜ë¦¬ ê³¼ì •
âœ… ë³´ì•ˆ ë° ì¸ì¦ ì²´ê³„
âœ… í•„í„°ë§ ì „ëµ (Label ê¸°ë°˜)
âœ… íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ
âœ… ì‹¤ì „ í™œìš© ì˜ˆì‹œ
âœ… ì„±ëŠ¥ ìµœì í™” ë°©ë²•
âœ… ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•µì‹¬ ìš”ì•½

1. **Filebeat**: Label ê¸°ë°˜ìœ¼ë¡œ í•„ìš”í•œ ë¡œê·¸ë§Œ ìˆ˜ì§‘
2. **Logstash**: ë³€í™˜/ë¼ìš°íŒ… (í˜„ì¬ëŠ” pass-through)
3. **Elasticsearch**: ì¸ë±ì‹±/ê²€ìƒ‰/ì €ì¥
4. **Kibana**: ì‹œê°í™”/ë¶„ì„/ì•ŒëŒ

### ë‹¤ìŒ ë‹¨ê³„

1. Logstash filter ì¶”ê°€í•˜ì—¬ ë¡œê·¸ íŒŒì‹±
2. Kibana ëŒ€ì‹œë³´ë“œ êµ¬ì„±
3. ì•ŒëŒ ì„¤ì •ìœ¼ë¡œ í”„ë¡œì•¡í‹°ë¸Œ ëª¨ë‹ˆí„°ë§
4. ILMìœ¼ë¡œ ì¸ë±ìŠ¤ ë¼ì´í”„ì‚¬ì´í´ ìë™í™”
5. í”„ë¡œë•ì…˜ í™˜ê²½ìœ¼ë¡œ í™•ì¥ (ê³ ê°€ìš©ì„±)

---

**ì‘ì„±ì¼**: 2025-10-15
**í”„ë¡œì íŠ¸**: DeukNet
**ë²„ì „**: 1.0
**ë¬¸ì˜**: [your-email]

